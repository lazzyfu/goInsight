(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7a522b18"],{"06c5":function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));r("a630"),r("fb6a"),r("b0c0"),r("d3b7"),r("25f0"),r("3ca3");var n=r("6b75");function a(e,t){if(e){if("string"===typeof e)return Object(n["a"])(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Object(n["a"])(e,t):void 0}}},"4ad3":function(e,t,r){"use strict";r.d(t,"s",(function(){return a})),r.d(t,"j",(function(){return o})),r.d(t,"l",(function(){return i})),r.d(t,"k",(function(){return s})),r.d(t,"t",(function(){return u})),r.d(t,"c",(function(){return c})),r.d(t,"n",(function(){return l})),r.d(t,"m",(function(){return d})),r.d(t,"v",(function(){return f})),r.d(t,"i",(function(){return m})),r.d(t,"q",(function(){return h})),r.d(t,"o",(function(){return b})),r.d(t,"p",(function(){return p})),r.d(t,"h",(function(){return g})),r.d(t,"g",(function(){return v})),r.d(t,"r",(function(){return y})),r.d(t,"b",(function(){return k})),r.d(t,"a",(function(){return q})),r.d(t,"f",(function(){return _})),r.d(t,"u",(function(){return w})),r.d(t,"d",(function(){return x})),r.d(t,"w",(function(){return S})),r.d(t,"e",(function(){return F})),r.d(t,"x",(function(){return C}));r("99af");var n=r("b775"),a=n["b"].request({url:"/users/list",method:"get"}),o=n["b"].request({url:"/sqlorders/envs",method:"get"}),i=n["b"].request({url:"/sqlorders/versions/get",method:"get"}),s=function(e){return n["b"].request({url:"/sqlorders/schemas",method:"get",params:e})},u=function(e){return n["b"].request({url:"/sqlorders/incep/syntaxcheck",method:"post",data:e})},c=function(e){return n["b"].request({url:"/sqlorders/commit",method:"post",data:e})},l=function(e){return n["b"].request({url:"/sqlorders/list",method:"get",params:e})},d=function(e){return n["b"].request({url:"/sqlorders/detail/".concat(e),method:"get"})},f=function(e){return n["b"].request({url:"/sqlorders/op/".concat(e.action,"/").concat(e.pk),method:"put",data:e})},m=function(e){return n["b"].request({url:"/sqlorders/tasks/generate",method:"post",data:e})},h=function(e){return n["b"].request({url:"/sqlorders/tasks/preview/".concat(e.task_id),method:"get",params:e})},b=function(e){return n["b"].request({url:"/sqlorders/tasks/get/".concat(e.order_id),method:"get",params:e})},p=function(e){return n["b"].request({url:"/sqlorders/tasks/list/".concat(e.task_id),method:"get",params:e})},g=function(e){return n["b"].request({url:"/sqlorders/tasks/execute/single",method:"post",data:e})},v=function(e){return n["b"].request({url:"/sqlorders/tasks/execute/multi",method:"post",data:e})},y=function(e){return n["b"].request({url:"/sqlorders/tasks/result/".concat(e),method:"get"})},k=function(e){return n["b"].request({url:"/sqlorders/tasks/throttle",method:"post",data:e})},q=function(e){return n["b"].request({url:"/sqlorders/hook",method:"post",data:e})},_=function(e){return n["b"].request({url:"/sqlorders/export/download/".concat(e),method:"get",responseType:"blob"})},w=function(e){return n["b"].request({url:"/sqlorders/versions/list",method:"get",params:e})},x=function(e){return n["b"].request({url:"/sqlorders/versions/create",method:"post",data:e})},S=function(e){return n["b"].request({url:"/sqlorders/versions/update/".concat(e.key),method:"put",data:e})},F=function(e){return n["b"].request({url:"/sqlorders/versions/delete/".concat(e),method:"delete",data:e})},C=function(e){return n["b"].request({url:"/sqlorders/versions/view/".concat(e),method:"get",params:e})}},"6b75":function(e,t,r){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r.d(t,"a",(function(){return n}))},"780d":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-card",{attrs:{title:"上线版本号"}},[r("div",{staticClass:"table-page-search-wrapper"},[r("a-row",{attrs:{gutter:[8,16]}},[r("a-col",{attrs:{span:10}},[r("a-button",{attrs:{icon:"file-add"},on:{click:function(t){return e.addVersion()}}},[e._v("新建")])],1),r("a-col",{attrs:{span:14}},[r("a-row",{attrs:{gutter:[8,16]}},[r("a-form",{attrs:{layout:"inline",form:e.form},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch(t)}}},[r("a-col",{attrs:{span:8}},[r("a-form-item",[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:e.decorator["search"],expression:"decorator['search']"}],attrs:{placeholder:"输入要检索的内容"}})],1)],1),r("a-col",{attrs:{span:8}},[r("span",{staticClass:"table-page-search-submitButtons"},[r("a-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("查询")]),r("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.resetForm}},[e._v("重置")])],1)])],1)],1)],1)],1)],1),r("a-table",{attrs:{columns:e.table.columns,rowKey:function(e){return e.id},dataSource:e.table.data,pagination:e.pagination,loading:e.loading,size:"middle"},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"id",fn:function(t,n){return[r("router-link",{attrs:{to:{name:"view.sqlorders.version.view",params:{version:n.version}}}},[e._v("详情")])]}},e._l(["version","expire_time"],(function(t){return{key:t,fn:function(n,a){return[r("div",{key:t},[a.editable?r("a-input",{staticStyle:{margin:"-5px 0"},attrs:{value:n},on:{change:function(r){return e.handleChange(r.target.value,a.key,t)}}}):[e._v(e._s(n))]],2)]}}})),{key:"key",fn:function(t,n){return[r("div",{staticClass:"editable-row-operations"},[n.editable?r("span",[r("a",{on:{click:function(){return e.save(n.key)}}},[r("a-tag",[e._v("保存")])],1),r("a-popconfirm",{attrs:{title:"Sure to cancel?"},on:{confirm:function(){return e.cancel(n.key)}}},[r("a",[r("a-tag",[e._v("关闭")])],1)])],1):r("span",[r("a",{attrs:{disabled:""!==e.editingKey},on:{click:function(){return e.edit(n.key)}}},[e._v("编辑")])]),r("a",{staticStyle:{margin:"10px"},attrs:{type:"dashed"},on:{click:function(r){return e.DeleteConfirm(t)}}},[e._v("删除")])])]}}],null,!0)}),r("a-modal",{attrs:{title:"新建版本"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[r("template",{slot:"footer"},[r("a-button",{key:"back",on:{click:e.handleCancel}},[e._v("关闭")]),r("a-button",{key:"submit",attrs:{type:"primary"},on:{click:e.handleVersionCommit}},[e._v("提交")])],1),r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px",size:"small"}},[r("el-form-item",{attrs:{label:"版本名称",prop:"version"}},[r("el-input",{model:{value:e.ruleForm.version,callback:function(t){e.$set(e.ruleForm,"version",t)},expression:"ruleForm.version"}})],1),r("el-form-item",{attrs:{label:"截止日期",prop:"expire_time"}},[r("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.ruleForm.expire_time,callback:function(t){e.$set(e.ruleForm,"expire_time",t)},expression:"ruleForm.expire_time"}})],1)],1)],2)],1)},a=[],o=(r("4de4"),r("d3b7"),r("ac1f"),r("841c"),r("6b75"));function i(e){if(Array.isArray(e))return Object(o["a"])(e)}r("a4d3"),r("e01a"),r("d28b"),r("a630"),r("3ca3"),r("ddb0");function s(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}var u=r("06c5");function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e){return i(e)||s(e)||Object(u["a"])(e)||c()}var d=r("5530"),f=r("4ad3"),m={data:function(){return{visible:!1,versions:[],loading:!1,table:{columns:[],data:[]},editingKey:"",pagination:{current:1,pageSize:10,total:0,pageSizeOptions:["10","20"],showSizeChanger:!0},decorator:{search:["search",{rules:[{required:!1}]}]},form:this.$form.createForm(this),ruleForm:{version:"",expire_time:""},rules:{version:[{required:!0,message:"请输入版本号",trigger:"blur"},{min:3,max:24,message:"长度在 3 到 24 个字符",trigger:"blur"}],expire_time:[{required:!0,message:"请选择截止日期",trigger:"change"}]}}},methods:{handleSearch:function(e){var t=this;e.preventDefault(),this.form.validateFields((function(e,r){e||(t.filters={search:r["search"]},t.pagination.current=1,t.fetchData())}))},resetForm:function(){this.form.resetFields()},handleTableChange:function(e){this.pagination.current=e.current,this.pagination.pageSize=e.pageSize,this.fetchData()},fetchData:function(){var e=this,t=Object(d["a"])({page_size:this.pagination.pageSize,page:this.pagination.current},this.filters);this.loading=!0,Object(f["u"])(t).then((function(t){e.pagination.total=t.count,e.loading=!1,e.table.columns=t.results.columns,e.table.data=t.results.data})).finally((function(){e.loading=!1}))},DeleteConfirm:function(e){var t=this;this.$confirm({title:"警告",content:"你确定删除？",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){Object(f["e"])(e).then((function(e){t.$message.info(e.message),t.fetchData()}))},onCancel:function(){}})},handleChange:function(e,t,r){var n=l(this.table.data),a=n.filter((function(e){return t===e.key}))[0];a&&(a[r]=e,this.table.data=n)},edit:function(e){var t=l(this.table.data),r=t.filter((function(t){return e===t.key}))[0];this.editingKey=e,r&&(r.editable=!0,this.table.data=t)},save:function(e){var t=this,r=l(this.table.data),n=r.filter((function(t){return e===t.key}))[0];n&&(delete n.editable,this.table.data=r,Object(f["w"])(n).then((function(e){"0000"===e.code?t.$message.info(e.message):t.$message.error(e.message),t.fetchData()}))),this.editingKey=""},cancel:function(e){var t=l(this.table.data),r=t.filter((function(t){return e===t.key}))[0];this.editingKey="",r&&(delete r.editable,this.table.data=t)},addVersion:function(){this.showModal()},showModal:function(){this.visible=!0},handleCancel:function(){this.visible=!1,this.$refs["ruleForm"].resetFields()},handleVersionCommit:function(e){var t=this;this.$refs["ruleForm"].validate((function(e){if(!e)return!1;var r=Object(d["a"])({username:t.$store.getters.userInfo.username},t.ruleForm);Object(f["d"])(r).then((function(e){"0000"===e.code?(t.$message.info(e.message),t.visible=!1,t.fetchData()):t.$message.error(e.message)})).finally((function(){t.visible=!1}))}))}},mounted:function(){this.fetchData()}},h=m,b=r("2877"),p=Object(b["a"])(h,n,a,!1,null,null,null);t["default"]=p.exports}}]);